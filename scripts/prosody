

deluser() { #Delete an existing IM account
    echo "Enter the name of the account you want to delete:"
    read PROSODY_DELETE_ACCOUNT
    prosodyctl deluser "${PROSODY_DELETE_ACCOUNT}@${FQDN}"
}

listusers() { #Get list of IM accounts on the server
    PROSODY_FQDN_STRING=$(echo $NZ_FQDN | sed 's/\./\%2e/g')
    PROSODY_ACCOUNT_FILES=$(find "/var/lib/prosody/${PROSODY_FQDN_STRING}/accounts" -name "*.dat")
    PROSODY_ACCOUNT_LIST=$(for i in ${PROSODY_ACCOUNT_FILES}; do basename $i .dat; done)
    echo "$PROSODY_ACCOUNT_LIST"
}

passwd() { #Change password for an IM account
    echo"Enter the name of the account you want to change the password for:"
    read PROSODY_PASSWD_ACCOUNT
    prosodyctl passwd "${PROSODY_PASSWD_ACCOUNT}@${FQDN}" 
}


status() { #Get IM server enabled/disabled status
    if [[ -f /var/run/prosody/prosody.pid ]]
    then echo "Prosody is enabled"
    else echo "Prosody is disabled"
    fi
        if grep "allow_registration = true" /etc/prosody/prosody.cfg.lua
        then echo "ÔÅ± New account registrations allowed"
        else echo "New account registrations not allowed"
    fi
}


if [ "$1" != "" ]
    then $@
    else listFunctions
fi